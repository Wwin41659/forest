<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="CAR stream does not include duplicated blocks, so to reconstruct a unixfs file, data does not follow the same layout as the expected target file. To recreate the file one must have the ability to read from arbitrary locations of the stream."><title>rs_car_ipfs::single_file - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-fa3bb1812debf86c.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="rs_car_ipfs" data-themes="" data-resource-suffix="" data-rustdoc-version="1.74.0 (79e9716c9 2023-11-13)" data-channel="1.74.0" data-search-js="search-8be46b629f5f14a8.js" data-settings-js="settings-74424d7eec62a23e.js" ><script src="../../static.files/storage-fec3eaa3851e447d.js"></script><script defer src="../../static.files/main-c5bd66d33317d69f.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-5d8b3c7633ad77ba.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../rs_car_ipfs/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a></nav><nav class="sidebar"><a class="logo-container" href="../../rs_car_ipfs/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module single_file</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">rs_car_ipfs</a>::<wbr><a class="mod" href="#">single_file</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/rs_car_ipfs/single_file/mod.rs.html#1-50">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>CAR stream does not include duplicated blocks, so to reconstruct a unixfs file,
data does not follow the same layout as the expected target file. To recreate
the file one must have the ability to read from arbitrary locations of the stream.</p>
<p>The seek module achieves this by requiring the <code>out</code> writer to also be <code>AsyncSeek + AsyncRead</code>
so that it duplicated data is found it can read from itself.</p>
<p>See example below of a CAR stream with de-duplicated nodes:</p>
<p>Target file chunked, uppercase letters = link nodes, lowercase letters = data nodes</p>
<div class="example-wrap"><pre class="language-n"><code>[ROOT                              ]
[X         ][Y         ][X         ]
[a][b][a][a][b][c][d][a][a][b][a][a]
</code></pre></div>
<p>Car stream layout, indexes represent time steps in the CAR stream read to match below.</p>
<div class="example-wrap"><pre class="language-n"><code>1     2  3  4  5  6  7
[ROOT][X][a][b][Y][c][d]
</code></pre></div>
<p>Representation of the “link stack”. Replacing a node with <code>[-]</code> represents writing its data to out.
For example at step 4, when <code>[b]</code> is recieved that node is written to out + immediately consecutive
nodes <code>[a][a]</code> are already known so those are written too.</p>
<div class="example-wrap"><pre class="language-n"><code>0 [ROOT]
1 [X][Y][X]
2 [a][b][a][a][Y][a][b][a][a]
3 [-][b][a][a][Y][a][b][a][a]
4 [-][-][-][-][Y][a][b][a][a]
5 [-][-][-][-][-][c][d][a][a][b][a][a]
6 [-][-][-][-][-][-][d][a][a][b][a][a]
7 [-][-][-][-][-][-][-][-][-][-][-][-]
</code></pre></div><h2 id="usage"><a href="#usage">Usage</a></h2>
<ul>
<li>To read a single file buffering the block dag <a href="fn.read_single_file_buffer.html" title="fn rs_car_ipfs::single_file::read_single_file_buffer"><code>read_single_file_buffer</code></a></li>
<li>To read a single file without buffering the block dag <a href="fn.read_single_file_seek.html" title="fn rs_car_ipfs::single_file::read_single_file_seek"><code>read_single_file_seek</code></a></li>
</ul>
</div></details><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.ReadSingleFileError.html" title="enum rs_car_ipfs::single_file::ReadSingleFileError">ReadSingleFileError</a></div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.read_single_file_buffer.html" title="fn rs_car_ipfs::single_file::read_single_file_buffer">read_single_file_buffer</a></div><div class="desc docblock-short">Read CAR stream from <code>car_input</code> as a single file buffering the block dag in memory</div></li><li><div class="item-name"><a class="fn" href="fn.read_single_file_seek.html" title="fn rs_car_ipfs::single_file::read_single_file_seek">read_single_file_seek</a></div><div class="desc docblock-short">Read CAR stream from <code>car_input</code> as a single file without buffering the block dag in memory,
reading de-duplicated blocks from <code>out</code>.</div></li></ul></section></div></main></body></html>